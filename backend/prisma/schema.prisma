generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Admin {
  admin_id      String     @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name          String?    @db.VarChar
  email         String     @unique @db.VarChar(255)
  password_hash String
  token_version Int        @default(0)
  created_at    DateTime   @default(now()) @db.Timestamptz(6)
  updated_at    DateTime   @default(now()) @db.Timestamptz(6)
  last_login_at DateTime?  @db.Timestamptz(6)
  Policies      Policies[]
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model Candidates {
  id              String          @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name            String?         @db.VarChar
  email           String?         @db.VarChar
  role            UserRole
  bio             String?
  dob             DateTime?       @db.Date
  phone_number    String?         @db.VarChar(20)
  user_id         String?         @db.Uuid
  applied_at      DateTime?       @db.Timestamptz(6)
  status          CandidateStatus @default(pending)
  cvUrl           String?
  certificateUrls String[]
  description     String?
  heading         String?
  hourly_rate     Float?
  location        String?
  prices          Float?
  qualifications  String[]
  subjects        String[]
  titles          String[]
  User            User?           @relation(fields: [user_id], references: [id], onDelete: Restrict)
}

model Free_Time_Slots {
  slot_id          String            @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  i_tutor_id       String?           @db.Uuid
  date             DateTime?         @db.Date
  status           SlotStatus?
  end_time         DateTime?         @db.Time(6)
  last_access_time DateTime?         @db.Timestamp(6)
  start_time       DateTime?         @db.Time(6)
  Individual_Tutor Individual_Tutor? @relation(fields: [i_tutor_id], references: [i_tutor_id], onDelete: Cascade, map: "i_tutor_id_slot_fk")
}

model Individual_Payments {
  i_payment_id      String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  student_id        String?   @db.Uuid
  session_id        String?   @db.Uuid
  amount            Decimal?  @db.Decimal(10, 2)
  payment_date_time DateTime? @db.Timestamp(6)
  status            Status?
  method            String?   @db.VarChar
  payment_intent_id String?
  Sessions          Sessions? @relation(fields: [session_id], references: [session_id], onDelete: Cascade)
  Student           Student?  @relation(fields: [student_id], references: [student_id], onDelete: NoAction, map: "student_id_i_pay_fk")
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model Individual_Tutor {
  i_tutor_id      String            @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  subjects        String[]          @db.VarChar
  titles          String[]          @db.VarChar
  hourly_rate     Decimal?          @db.Decimal(10, 2)
  user_id         String?           @db.Uuid
  description     String?
  rating          Decimal?          @db.Decimal(3, 1)
  heading         String?
  location        String?
  phone_number    String?           @db.VarChar
  qualifications  String[]
  status          TutorStatus       @default(active)
  cvUrl           String?           @default("")
  certificateUrls String[]
  Free_Time_Slots Free_Time_Slots[]
  User            User?             @relation(fields: [user_id], references: [id], onDelete: Cascade, map: "i_tutor_user_id_fk")
  Sessions        Sessions[]
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model Mass_Tutor {
  m_tutor_id     String      @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  subjects       String[]    @db.VarChar
  prices         Decimal?    @db.Decimal(10, 2)
  description    String?
  user_id        String?     @db.Uuid
  rating         Decimal?    @db.Decimal(3, 1)
  heading        String?
  status         TutorStatus @default(active)
  phone_number   String?     @db.VarChar
  qualifications String[]
  location       String?
  Class          Class[]
  User           User?       @relation(fields: [user_id], references: [id], onDelete: Cascade, map: "m_tutor_user_id_fk")
}

model Notifications {
  notify_id      String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  user_id        String?   @db.Uuid
  message        String?
  type           UserRole?
  date_time_sent DateTime? @db.Timestamp(6)
  status         Status?
  User           User?     @relation(fields: [user_id], references: [id], onDelete: Cascade, map: "user_id_notification_fk")
}

model Rating_N_Review_Session {
  r_id       String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  student_id String?   @db.Uuid
  session_id String?   @db.Uuid
  review     String?
  rating     Decimal?  @db.Decimal(3, 1)
  Sessions   Sessions? @relation(fields: [session_id], references: [session_id], onDelete: NoAction, map: "session_rating_review")
  Student    Student?  @relation(fields: [student_id], references: [student_id], onDelete: NoAction, map: "student_rating_review")
}

model Reports {
  id             String        @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  student_id     String?       @db.Uuid
  tutor_id       String?       @db.Uuid
  tutor_type     TutorType?
  description    String?
  reason         String?
  resolve_date   DateTime?     @db.Date
  response       String?
  status         ReportStatus? @default(under_review)
  submitted_date DateTime?     @db.Date
  Student        Student?      @relation(fields: [student_id], references: [student_id], onDelete: NoAction, map: "student_id_fk")
}

model Sessions {
  session_id              String                    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  student_id              String?                   @db.Uuid
  status                  SessionStatus?
  materials               String[]                  @db.VarChar
  created_at              DateTime?                 @db.Timestamp(6)
  date                    DateTime?                 @db.Date
  i_tutor_id              String?                   @db.Uuid
  meeting_urls            String[]
  price                   Float?
  slots                   DateTime[]                @db.Time
  title                   String?
  start_time              DateTime?                 @db.Timestamp(6)
  end_time                DateTime?                 @db.Timestamp(6)
  subject                 String?                   @db.VarChar
  Individual_Payments     Individual_Payments[]
  Rating_N_Review_Session Rating_N_Review_Session[]
  Individual_Tutor        Individual_Tutor?         @relation(fields: [i_tutor_id], references: [i_tutor_id], onDelete: Cascade, onUpdate: NoAction)
  Student                 Student?                  @relation(fields: [student_id], references: [student_id], onDelete: NoAction, map: "student_session_fk")
}

model Student {
  student_id              String                    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  user_id                 String                    @db.Uuid
  points                  Int?                      @default(0)
  customer_id             String?                   @db.VarChar
  Enrolment               Enrolment[]
  Individual_Payments     Individual_Payments[]
  Rating_N_Review_Class   Rating_N_Review_Class[]
  Rating_N_Review_Session Rating_N_Review_Session[]
  Reports                 Reports[]
  Sessions                Sessions[]
  User                    User                      @relation(fields: [user_id], references: [id], onDelete: Cascade, map: "student_user_Id_fk")
}

model Subjects {
  sub_id String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name   String?  @db.VarChar
  Titles Titles[]
}

model Titles {
  title_id String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  sub_id   String   @db.Uuid
  name     String?  @db.VarChar
  Subjects Subjects @relation(fields: [sub_id], references: [sub_id], onDelete: Cascade, map: "title_sub_id_fk")
}

model User {
  name             String             @db.VarChar(255)
  email            String             @unique @db.VarChar(255)
  role             UserRole
  bio              String
  dob              DateTime?          @db.Date
  created_at       DateTime           @default(now())
  firebase_uid     String             @unique
  photo_url        String?
  id               String             @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  Candidates       Candidates[]
  Individual_Tutor Individual_Tutor[]
  Mass_Tutor       Mass_Tutor[]
  Notifications    Notifications[]
  Student          Student[]
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model Class {
  class_id              String                  @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  created_at            DateTime                @default(now()) @db.Timestamptz(6)
  m_tutor_id            String?                 @db.Uuid
  subject               String?                 @db.VarChar
  time                  DateTime?               @db.Time(6)
  day                   String?                 @db.VarChar
  title                 String?
  description           String?
  product_id            String?                 @db.VarChar
  price_id              String?                 @db.VarChar
  Mass_Tutor            Mass_Tutor?             @relation(fields: [m_tutor_id], references: [m_tutor_id], onDelete: Cascade)
  ClassSlot             ClassSlot[]
  Enrolment             Enrolment[]
  Rating_N_Review_Class Rating_N_Review_Class[]
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model ClassSlot {
  cslot_id     String           @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  created_at   DateTime         @default(now()) @db.Timestamptz(6)
  class_id     String?          @db.Uuid
  materials    String[]
  meetingURLs  String[]
  dateTime     DateTime?        @db.Timestamp(6)
  duration     Float?           @db.Real
  announcement String?
  recording    String?
  status       ClassSlotStatus? @default(upcoming)
  Class        Class?           @relation(fields: [class_id], references: [class_id], onDelete: Cascade)
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model Enrolment {
  enrol_id        String           @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  created_at      DateTime         @default(now()) @db.Timestamptz(6)
  class_id        String?          @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  student_id      String?          @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  status          EnrolmentStatus? @default(valid)
  subscription_id String?          @db.VarChar
  Class           Class?           @relation(fields: [class_id], references: [class_id], onDelete: Cascade)
  Student         Student?         @relation(fields: [student_id], references: [student_id], onDelete: Cascade)
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model Mass_Payments {
  m_payment_id      String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  payment_time      DateTime @default(now()) @db.Timestamptz(6)
  student_id        String?  @db.Uuid
  amount            Float?
  class_id          String?  @db.Uuid
  paidMonth         String?  @db.VarChar
  status            Status?
  method            String?
  payment_intent_id String?
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model Rating_N_Review_Class {
  r_id       String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  created_at DateTime @default(now()) @db.Timestamptz(6)
  student_id String?  @db.Uuid
  class_id   String?  @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  rating     Float?   @db.Real
  review     String?
  Class      Class?   @relation(fields: [class_id], references: [class_id], onDelete: Cascade)
  Student    Student? @relation(fields: [student_id], references: [student_id], onDelete: Cascade)
}

model Policies {
  policy_id   String   @id(map: "policies_pkey") @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  policy_name String   @unique(map: "uq_policies_policy_name") @db.VarChar(255)
  type        String   @db.VarChar(50)
  description String?
  created_at  DateTime @default(now()) @db.Timestamptz(6)
  updated_at  DateTime @default(now()) @db.Timestamptz(6)
  updated_by  String?  @db.Uuid
  Admin       Admin?   @relation(fields: [updated_by], references: [admin_id], map: "fk_policies_updated_by")
}

/// This enum is commented in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
enum CandidateStatus {
  pending
  approved
  rejected
}

enum ReportStatus {
  under_review @map("under review")
  solve
}

enum SessionStatus {
  scheduled
  ongoing
  canceled
  completed
}

enum SlotStatus {
  free
  booked
}

enum Status {
  success
  fail
  refund
}

/// This enum is commented in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
enum TutorStatus {
  active
  suspended
  pending
}

enum TutorType {
  mass
  individual
}

enum UserRole {
  student
  Individual
  Mass
  Admin
}

enum EnrolmentStatus {
  valid
  invalid
}

enum ClassSlotStatus {
  completed
  upcoming
}
